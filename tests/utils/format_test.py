# -*- coding: utf-8 -*-
from costreduce.utils.format import grid
from textwrap import dedent
import re


def clean(text):
    return re.sub(r"( +)$", "", text, flags=re.MULTILINE) + "\n"


is_empty = dedent(
    """\
+-------+------------+------------+------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   #   |  Provider  |    Type    |   Region   |  Service   |                                                                                     Description                                                                                      |
+=======+============+============+============+============+======================================================================================================================================================================================+
+-------+------------+------------+------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
"""
)
is_not_empty = dedent(
    """\
+-------+------------+------------+------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   #   |  Provider  |    Type    |   Region   |  Service   |                                                                                     Description                                                                                      |
+=======+============+============+============+============+======================================================================================================================================================================================+
| 0     | AWS        | Compute    | EC2        | region     | t                                                                                                                                                                                    |
+-------+------------+------------+------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1     | AWS        | Compute    | EC2        | region     | e                                                                                                                                                                                    |
+-------+------------+------------+------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2     | AWS        | Compute    | EC2        | region     | s                                                                                                                                                                                    |
+-------+------------+------------+------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 3     | AWS        | Compute    | EC2        | region     | t                                                                                                                                                                                    |
+-------+------------+------------+------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
"""
)


def test_grid_is_empty():
    result = grid("", "", "", "", "")
    clean(result).should.equal(is_empty)


def test_grid_is_not_empty():
    result = grid("test", "AWS", "Compute", "region", "EC2")
    clean(result).should.equal(is_not_empty)
